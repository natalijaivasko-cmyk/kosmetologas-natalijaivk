<script>
  const SERVICES = [
    {
      cat: "Valymai",
      title: "Veido valymas",
      duration: "1 val. 30 min.",
      price: "70 €",
      descHtml: `
        <p>Procedūros metu atliekamas enziminis ir rūgštinis veido šveitimas, šaltasis drėkinimas, porų paruošimas valymui, mechaninis valymas.</p>
        <p>Po procedūros uždedama priešuždegiminė, antibakterinė ir raminamoji kaukė, taikoma LED terapija.</p>
        <p><strong>Į procedūrą įeina</strong> išsami konsultacija ir namų priežiūros rekomendacijos.</p>
      `
    },

    {
      cat: "Pilingai",
      title: "Veido rūgštinis pilingas",
      duration: "60 min.",
      price: "50 €",
      descHtml: `
        <p>Tai profesionali odos atnaujinimo procedūra, kurios metu naudojami individualiai parinkti rūgščių kokteiliai, pritaikyti konkrečiai odos problemai ir poreikiui.</p>
        <p><strong>Rūgščių deriniai parenkami individualiai, esant:</strong></p>
        <ul>
          <li>Kuperozei ir rožinei (stiprinamas kapiliarų tonusas, mažinamas paraudimas)</li>
          <li>Aknės ir postaknei (reguliuojama sebumo sekrecija, valomos poros)</li>
          <li>Pigmentacijai ir netolygiam odos tonui</li>
          <li>Porų mažinimui ir odos reljefo lyginimui</li>
          <li>Liftingo ir anti-age efektui (smulkios raukšlės, stangrumo stoka)</li>
          <li>„Glow“ efektui – skaistesnei, gaivesnei odai</li>
        </ul>
      `
    },

    {
      cat: "Pilingai",
      title: "Biorevitalizuojantis rūgštinis pilingas",
      duration: "60 min.",
      price: "60 €",
      descHtml: `
        <p>Unikali formulė jungia rūgštis, amino rūgštis, vitaminus ir antioksidantus, todėl pilingas ne tik šveičia, bet ir aktyviai atkuria odą iš vidaus, nesukeldamas ryškaus paraudimo ar pleiskanojimo.</p>
        <p><strong>Tinka:</strong></p>
        <ul>
          <li>Papilkėjusiai, pavargusiai odai</li>
          <li>Esant pigmentacijai, nelygiam odos tonui</li>
          <li>Po aknės, esant randeliams ir nelygumams</li>
          <li>Smulkioms raukšlėms, elastingumo praradimui</li>
          <li>Suteikia skaistumo, stangrumo ir „glow“ efektą</li>
        </ul>
      `
    },

    {
      cat: "Mikroadatinės procedūros",
      title: "Dermapen procedūra veidui",
      duration: "60 min.",
      price: "70 €",
      descHtml: `
        <p>Tai moderni procedūra, skirta odos atsinaujinimui, stangrinimui ir tekstūros gerinimui. Procedūra atliekama individualiai parinkus protokolą ir aktyvius serumus (hialurono rūgštį, peptidus, vitaminus, PDRN ir kt.), atsižvelgiant į odos būklę ir tikslą.</p>
        <ul>
          <li>Gerina odos tekstūrą ir tonusą</li>
          <li>Mažina smulkias raukšles</li>
          <li>Stangrina ir atjaunina odą</li>
          <li>Padeda koreguoti randelius ir postakne</li>
          <li>Mažina išsiplėtusias poras</li>
          <li>Gerina odos drėgmės balansą ir švytėjimą</li>
          <li>Stiprina kapiliarus, mažina raudonį</li>
        </ul>
      `
    },

    {
      cat: "Injekcinės / giluminės procedūros",
      title: "Procedūra, veikianti giliuosius odos sluoksnius",
      duration: "60 min.",
      price: "120 €",
      descHtml: `
        <p>Tai efektyvi estetinė procedūra, veikianti giliuosius odos sluoksnius, skatinanti ląstelių atsinaujinimą, gerinanti odos būklę ir stabdanti senėjimo procesus.</p>
        <p>Procedūrai naudojami individualiai parinkti kokteiliai, kurių sudėtyje gali būti: hialurono rūgštis, vitaminai ir mineralai, aminorūgštys, peptidai, polinukleotidai (PN / PDRN), antioksidantai.</p>
        <ul>
          <li>Intensyvus odos drėkinimas</li>
          <li>Stangrumo ir elastingumo gerinimas</li>
          <li>Smulkių raukšlių mažinimas</li>
          <li>Odos tono ir tekstūros gerinimas</li>
          <li>Švytėjimo („glow“) efektas</li>
          <li>Pagreitintas odos atsistatymas</li>
          <li>Kapiliarų stiprinimas</li>
          <li>Veido apimčių mažinimas</li>
          <li>Pigmentacijos mažinimas</li>
        </ul>
      `
    },

    {
      cat: "Galvos odai",
      title: "Dermapen procedūra galvos odai",
      duration: "40 min.",
      price: "60 €",
      descHtml: `
        <p>Tai efektyvi procedūra, skirta plaukų slinkimo mažinimui, plaukų augimo skatinimui ir galvos odos būklės gerinimui. Aktyvina kraujotaką ir folikulų mitybą, stimuliuoja plaukų augimo faktorius, gerina aktyviųjų medžiagų įsisavinimą, pažadina „miegančius“ plaukų folikulus.</p>
        <p>Tinka esant difuziniam ar sezoniniam plaukų slinkimui, po streso, ligų ar hormoninių pokyčių, esant silpnai, išretėjusiai plaukų linijai, tiek moterims, tiek vyrams, kaip palaikomoji terapija po plaukų transplantacijos.</p>
        <ul>
          <li>Mažina plaukų slinkimą</li>
          <li>Skatina naujų plaukų augimą</li>
          <li>Stiprina plaukų šaknis</li>
          <li>Gerina galvos odos kraujotaką</li>
          <li>Normalizuoja riebalų išsiskyrimą</li>
          <li>Gerina bendrą galvos odos būklę</li>
        </ul>
      `
    },

    {
      cat: "Paaugliams",
      title: "Procedūra paaugliams",
      duration: "1 val. 30 min.",
      price: "45 €",
      descHtml: `
        <p>Tai kompleksinė, saugi ir edukacinė procedūra, skirta aknės gydymui, tinkamos odos priežiūros parinkimui ir sveikų įpročių formavimui paauglystėje. Procedūra orientuota ne tik į esamų bėrimų mažinimą, bet ir į aknės priežasčių supratimą, kad rezultatai būtų ilgalaikiai.</p>
        <p><strong>Procedūra apima:</strong></p>
        <ul>
          <li>Odos būklės ir aknės formos įvertinimą</li>
          <li>Švelnų, amžiui pritaikytą odos valymą</li>
          <li>Priešuždegimines ir raminančias priemones</li>
          <li>Individualų kasdienės odos priežiūros parinkimą</li>
          <li>Išsamias gyvenimo būdo, mitybos ir higienos rekomendacijas</li>
        </ul>
      `
    },

    {
      cat: "Masažai",
      title: "Gilus terapinis veido masažas",
      duration: "60 min.",
      price: "45 €",
      descHtml: `
        <p>Tai intensyvi, rankomis atliekama terapinė procedūra, skirta veido raumenų atpalaidavimui, kraujotakos ir limfotakos gerinimui bei natūraliam liftingo efektui. Procedūra veikia ne tik odą, bet ir giliuosius veido raumenis bei fascijas, todėl rezultatai matomi jau po pirmo seanso.</p>
        <p>Naudojamos giluminės, lėtos ir tikslios technikos, dirbama su veido, kaklo ir pečių juostos raumenimis, fascijomis, limfine sistema.</p>
        <ul>
          <li>Atpalaiduoja įsitempusius veido raumenis</li>
          <li>Mažina raumeninius spazmus ir asimetrijas</li>
          <li>Gerina kraujotaką ir limfos nutekėjimą</li>
          <li>Ryškina veido kontūrus ir ovalą</li>
          <li>Suteikia liftingo ir „anti-age“ efektą</li>
          <li>Mažina paburkimą ir nuovargio požymius</li>
        </ul>
        <p>Procedūra atliekama individualiai, atsižvelgiant į veido anatomiją ir poreikius.</p>
      `
    }
  ];

  const $grid = document.getElementById('grid');
  const $q = document.getElementById('q');
  const $cat = document.getElementById('category');

  function uniq(a){ return [...new Set(a)] }
  function escapeHtml(s){
    return String(s||'').replace(/[&<>\"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]))
  }
  function stripTags(html){
    return String(html||'').replace(/<[^>]*>/g,' ').replace(/\s+/g,' ').trim();
  }

  // Paruošiam paieškos tekstą, kad paieška veiktų ir su HTML aprašymais
  const SERVICES_PREP = SERVICES.map(s => ({
    ...s,
    _search: (s.title + ' ' + s.cat + ' ' + stripTags(s.descHtml)).toLowerCase()
  }));

  function buildCats(){
    const cats = uniq(SERVICES_PREP.map(s=>s.cat)).sort((a,b)=>a.localeCompare(b,'lt'));
    $cat.innerHTML =
      '<option value="all">Visos kategorijos</option>' +
      cats.map(c=>`<option value="${escapeHtml(c)}">${escapeHtml(c)}</option>`).join('');
  }

  function render(){
    const q = ($q.value||'').toLowerCase().trim();
    const cat = $cat.value;

    const items = SERVICES_PREP.filter(s =>
      (cat==='all' || s.cat===cat) &&
      (!q || s._search.includes(q))
    );

    $grid.innerHTML = items.map(s => `
      <article class="card" tabindex="0">
        <div class="cat">${escapeHtml(s.cat)}</div>
        <div class="title">${escapeHtml(s.title)}</div>
        <div class="meta">Trukmė: ${escapeHtml(s.duration)} <span class="price">• ${escapeHtml(s.price)}</span></div>
        <div class="desc">${s.descHtml}</div>
      </article>
    `).join('') || '<p class="muted">Nerasta atitinkančių procedūrų.</p>';
  }

  $q.addEventListener('input', render);
  $cat.addEventListener('change', render);
  buildCats();
  render();
</script>
